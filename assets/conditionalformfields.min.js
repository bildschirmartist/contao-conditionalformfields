!function(a,b,c,d){"use strict";function g(b,c){this.element=b,this.settings=a.extend({},f,c),this._defaults=f,this._name=e,this.init()}var e="conditionalFormFields",f={fields:[],conditions:{}};a.extend(g.prototype,{init:function(){var b=this;b.initFields(),b.initFieldsets(),a(this.element).on("ajax_change",function(){b.initFields(),b.initFieldsets()})},initFields:function(){var b=this;b.fields={},a(b.settings.fields).each(function(c,d){a(b.element).find('*[name^="'+d+'"]').each(function(){var c=a(this),d=c.attr("name");"[]"==d.substr(d.length-2)?(d=d.substr(0,d.length-2),b.fields[d]instanceof Array||(b.fields[d]=[]),b.fields[d].push(c)):"radio"===c.attr("type")?(b.fields[d]instanceof Array||(b.fields[d]=[]),b.fields[d].push(c)):b.fields[d]=c,a(this).on("change",function(){b.toggleFieldsets()})})})},initFieldsets:function(){var b=this;b.fieldsets={},b.fieldsetFields={};for(var c in b.settings.conditions)b.fieldsets[c]=a(".cffs-"+c),b.fieldsetFields[c]=b.fieldsets[c].find("input, select, textarea");b.toggleFieldsets()},toggleFieldsets:function(){var a=this,b=a.getFieldValues();for(var c in a.settings.conditions){var d="var in_array = function(needle, haystack) { return jQuery.isArray(haystack) ? (jQuery.inArray(needle, haystack) != -1) : false; }; "+a.settings.conditions[c],e=new Function("values",d);e(b)?a.showFieldset(c):a.hideFieldset(c)}},showFieldset:function(b){this.fieldsets[b].show(),a(this.fieldsetFields[b]).each(function(){a(this).attr("disabled",!1)})},hideFieldset:function(b){this.fieldsets[b].hide(),a(this.fieldsetFields[b]).each(function(){a(this).attr("disabled",!0)})},getFieldValues:function(){var b=this,c={},e=null;return a.each(b.fields,function(f){a.isArray(this)?a(this).each(function(){if("radio"===a(this).attr("type")){if(e=b.getFieldValue(this))return c[f]=e,!1}else d===c[f]&&(c[f]=[]),e=b.getFieldValue(this),e&&c[f].push(e)}):(e=b.getFieldValue(this),e&&(c[f]=e))}),c},getFieldValue:function(b){return b=a(b),"checkbox"==b.attr("type")||"radio"==b.attr("type")?b.is(":checked")?b.val():null:b.val()}}),a.fn[e]=function(b){return this.each(function(){a.data(this,"plugin_"+e)||a.data(this,"plugin_"+e,new g(this,b))})}}(jQuery,window,document);
